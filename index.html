<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>捷途大伦哥的应用管家</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div style="margin: 20px 0; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;">
            <div style="background-color: #e3f2fd; padding: 10px 15px; border-bottom: 1px solid #dee2e6;">
                <h3 style="margin: 0; font-size: 16px;">安装方式一：手机App方式</h3>
            </div>
            <div style="padding: 15px; background-color: white;">
                <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                    <a href="https://adb.cheji.cc/apk/sj.apk" class="btn btn-connect" style="flex-shrink: 0;" target="_blank">手机助手下载</a>
                    <a href="https://file.vju.cc/%E5%BA%94%E7%94%A8%E7%AE%A1%E5%AE%B6/%E5%BA%94%E7%94%A8%E7%AE%A1%E5%AE%B61.8.0%E5%85%AC%E7%AD%BE%E7%89%88.apk" class="btn btn-connect" style="flex-shrink: 0;" target="_blank">应用管家下载</a>
                </div>
            </div>
        </div>
        
        <hr style="margin: 20px 0; border: 1px solid #eee;">
        
        <div style="margin: 20px 0; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;">
            <div style="background-color: #e3f2fd; padding: 10px 15px; border-bottom: 1px solid #dee2e6;">
                <h3 style="margin: 0; font-size: 16px;">安装方式二：WebUSB方式</h3>
            </div>
            <div style="padding: 15px; background-color: white;">
                <div class="warning" id="usb-warning">
                    注意！您的浏览器不支持WebUSB。<br>
                    请在Edge浏览器中打开
                </div>
                
                <!-- Edge浏览器下载地址已隐藏，将在检测到非支持浏览器时弹窗显示 -->
                
                <div style="margin: 20px 0;">
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
                        <button class="btn btn-connect" id="connect-btn" onclick="connect()" style="background-color: #28a745; color: white;">连接设备</button>
                        <button class="btn btn-disconnect" id="disconnect-btn" onclick="disconnect()" style="background-color: #dc3545; color: white;">断开连接</button>
                        <div style="flex: 1; text-align: right;">
                            <span style="margin-right: 8px;">🚗 当前设备：</span>
                            <span id="device-status" style="font-weight: bold;">未连接</span>
                        </div>
                    </div>
                    <p style="font-size: 12px; color: #6c757d; margin: 0;">
                        如显示"找不到兼容设备"，请重新拔插OTG线的车机端的USB口 或 检查adb通道是否被其它占用。
                    </p>
                    <!-- 设备情况日志 -->
                    <div style="margin-top: 10px; padding: 10px; background-color: #f8f9fa; border-radius: 4px; font-size: 12px; font-family: monospace; max-height: 100px; overflow-y: auto;">
                        <div style="font-weight: bold; margin-bottom: 5px; color: #333;">设备情况日志：</div>
                        <div id="device-log" style="white-space: pre-wrap;">正在初始化...</div>
                    </div>
                </div>
                
                <hr style="margin: 20px 0; border: 1px solid #eee;">
                
                <!-- 必装软件 -->
                <div style="margin: 20px 0; background-color: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin-top: 0; margin-bottom: 15px;">必装软件</h4>
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-connect" onclick="yygj()" style="flex-shrink: 0;">应用管家</button>
                        <button class="btn btn-connect" onclick="cdb()" style="flex-shrink: 0;">侧边栏</button>
                        <button class="btn btn-connect" onclick="qzm()" style="flex-shrink: 0;">氢桌面</button>
                        <button class="btn btn-connect" onclick="sfgj()" style="flex-shrink: 0;">沙发管家</button>    
                        <button class="btn btn-connect" onclick="qxg()" style="flex-shrink: 0;">权限狗</button>        
                    </div>
                    <p style="margin-top: 10px; font-size: 12px; color: #6c757d;">请先安装以上软件，以确保系统正常运行。</p>
                </div>
                
                <!-- 自选安装 -->
                <div style="margin: 20px 0; background-color: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin-top: 0; margin-bottom: 15px;">自主安装</h4>
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                        <input type="file" id="apkFile" multiple accept=".apk" style="display: none;">
                        <button class="btn btn-connect" onclick="loadApkFile()" style="flex-shrink: 0;">选择文件</button>
                        <span id="apkFileName" style="flex: 1; min-width: 200px; padding: 8px; background-color: white; border: 1px solid #dee2e6; border-radius: 4px;">未选择文件</span>
                        <button class="btn btn-connect" onclick="installApkFile()" style="flex-shrink: 0; background-color: #007bff;">安装所选</button>
                    </div>
                    <p style="margin-top: 10px; font-size: 12px; color: #6c757d;">操作点击按钮后请静候等待执行结果，切勿重复点击！</p>
                </div>
                
                <!-- Shell Command Input -->
                <div style="margin: 20px 0; background-color: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin-top: 0; margin-bottom: 15px;">手动命令</h4>
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                        <input type="text" id="shell" placeholder="输入ADB命令" style="flex: 1; min-width: 300px; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                        <button class="btn btn-connect" onclick="exec_command()" style="flex-shrink: 0;">执行命令</button>
                    </div>
                </div>
                
                <!-- 应用管理 -->
                <div style="margin: 20px 0; background-color: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin-top: 0; margin-bottom: 15px;">应用管理</h4>
                    
                    <!-- 常用应用启动按钮 -->
                    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button class="btn btn-connect" onclick="startAhuiApp()" style="flex-shrink: 0; background-color: #28a745;">启动应用管家</button>
                        <button class="btn btn-connect" onclick="exec_shell('monkey -p com.oversea.aslauncher -c android.intent.category.LAUNCHER 1')" style="flex-shrink: 0;">启动桌面</button>
                        <button class="btn btn-connect" onclick="exec_shell('monkey -p com.android.settings -c android.intent.category.LAUNCHER 1')" style="flex-shrink: 0;">启动设置</button>
                        <button class="btn btn-connect" onclick="exec_shell('am start -W -n com.hzsoft.sidebar/.MainActivity')" style="flex-shrink: 0;">启动侧边栏</button>
                    </div>
                    
                    <!-- 刷新应用列表 -->
                    <button class="btn btn-connect" onclick="loadPackageList()" style="margin-bottom: 15px;">刷新应用列表</button>
                    
                    <!-- 已安装应用列表 -->
                    <table id="package-list" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: #e9ecef;">
                                <th style="padding: 8px; border: 1px solid #dee2e6;">序号</th>
                                <th style="padding: 8px; border: 1px solid #dee2e6;">包名</th>
                                <th style="padding: 8px; border: 1px solid #dee2e6;">操作</th>
                                <th style="padding: 8px; border: 1px solid #dee2e6;">卸载</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 应用列表将通过JavaScript动态添加 -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Progress Bar -->
                <div class="progress" id="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
                </div>
                
                <!-- Log Area -->
                <div id="exec-result">
                    <h4>执行结果</h4>
                    <div id="log"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toasts -->
    <div class="toast" id="downloading-toast">
        <div>正在下载，请稍候...</div>
        <div id="download-progress">
            <div id="download-progress-bar"></div>
        </div>
        <div id="download-progress-text">0%</div>
    </div>
    
    <div class="toast" id="success-toast">
        设备连接成功！
    </div>
    
    <!-- ADB 核心模块 -->
    <script src="js/adb/transport.js"></script>
    <script src="js/adb/message.js"></script>
    <script src="js/adb/device.js"></script>
    <script src="js/adb/index.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="js/utils.js"></script>
    <script src="js/device.js"></script>
    <script src="js/apps.js"></script>
    <script src="js/system.js"></script>
    <script src="js/main.js"></script>
</body>
</html>